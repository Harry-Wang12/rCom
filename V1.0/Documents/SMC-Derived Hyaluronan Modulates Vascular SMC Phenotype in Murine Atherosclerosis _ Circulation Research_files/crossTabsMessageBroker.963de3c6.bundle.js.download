rmq_webpackJsonp([20],{20:function(h,b,a){h.exports=a("ynQ0")},"9LPS":function(h,b,a){Object.defineProperty(b,"__esModule",{value:!0});a.d(b,"TP_HEADER_NAME",function(){return f});a.d(b,"CSRF_HEADER_NAME",function(){return l});a.d(b,"CSRF_COOKIE_NAME",function(){return k});a.d(b,"TPC_BLOCKED_HEADER",function(){return n});a.d(b,"DEFAULT_USER_IMAGE",function(){return m});a.d(b,"WIDGET_NAMES",function(){return p});a.d(b,"WIDGET_STATUS",function(){return d});var f="X-RMRQ-SESSION",l="X-CSRF-TOKEN",k=
"XSRF-TOKEN",n="X-TPC-BLOCKED",m="images/Remarq-Logo-ForTopBar.png",p=Object.freeze(new function e(){var d=this;this.REMARQ="GroveSide";this.TOP_WIDGET="TopWidget";this.CORNER_WIDGET="CornerWidget";this.POLL_WIDGET="PollWidget";this.SURVEY_WIDGET="SurveyWidget";this.STICKY_WIDGET="Sticky";this.PDF_FRAME="pdfFrame";this.CROSS_TABS_MESSAGE_BROKER="CrossTabsMessageBroker";this.DASHBOARD="grove-body";this.PUBLIC_PROFILE="PublicProfile";e.prototype.fromFrameId=function(a){switch(a){case "GroveSide":return d.REMARQ;
case "SurveyWidget":return d.SURVEY_WIDGET;case "Sticky":return d.STICKY_WIDGET;case "PollWidget":return d.POLL_WIDGET;case "CornerWidget":return d.CORNER_WIDGET;case "TopWidget":return d.TOP_WIDGET;case "pdfFrame":return d.PDF_FRAME;default:return null}}}),d=Object.freeze(new function(){this.INITIALIZED="INITIALIZED";this.LOADING="LOADING";this.UNINSTALLED="UNINSTALLED"})},JyB8:function(h,b,a){Object.defineProperty(b,"__esModule",{value:!0});h=function(){function a(){this.holder={}}a.prototype.put=
function(a,b){return this.holder&&b&&a?(this.holder[a]=b,!0):!1};a.prototype.get=function(a){return this.holder&&a&&this.holder[a]?this.holder[a]:null};a.prototype.contains=function(a){return!!(this.holder&&a&&0<=Object.keys(this.holder).indexOf(a))};a.prototype.remove=function(a){this.holder&&a&&delete this.holder[a]};a.prototype.isEmpty=function(){if(this.holder){var a=Object.keys(this.holder);if(a&&Array.isArray(a))return 0===a.length}return!1};a.prototype.delegate=function(a){return a&&"function"===
typeof a?a(this):null};a.prototype.values=function(){var a=this;return this.holder&&"object"===typeof this.holder?Object.keys(this.holder).map(function(b){return a.holder[b]}):[]};a.prototype.keys=function(){return this.holder&&"object"===typeof this.holder?Object.keys(this.holder):[]};a.prototype.clear=function(){var a=this;this.holder&&"object"===typeof this.holder&&Object.keys(this.holder).forEach(function(b){return delete a.holder[b]})};a.prototype.updateBucketProperty=function(a,b,h,f){return(f=
this.get(a))&&b?(f[b]=h,this.put(a,f),!0):!1};return a}();b.HolderUtil=h},Tkzw:function(h,b,a){function f(a){var c=l();return function(){var d=m()(a);if(c){var b=m()(this).constructor;d=Reflect.construct(d,arguments,b)}else d=d.apply(this,arguments);return n()(this,d)}}function l(){if("undefined"===typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(S){return!1}}
Object.defineProperty(b,"__esModule",{value:!0});a.d(b,"GroveMessage",function(){return e});a.d(b,"AddDuplicateArticleToReadingList",function(){return q});a.d(b,"WidgetInitializedEvent",function(){return r});a.d(b,"UpdateCurrentPollEvent",function(){return z});a.d(b,"UpdateCurrentPollWidgetEvent",function(){return A});a.d(b,"WidgetDestroyedEvent",function(){return B});a.d(b,"ToggleWidgetEvent",function(){return C});a.d(b,"ActiveSurveysEvent",function(){return D});a.d(b,"UpdateSurveyFilterEvent",function(){return E});
a.d(b,"InvalidateSurveyFiltersEvent",function(){return F});a.d(b,"GMLoginEvent",function(){return G});a.d(b,"ExpandWidgetEvent",function(){return H});a.d(b,"ReloadWidgetEvent",function(){return I});a.d(b,"SubmitCompletedSurveyErrorEvent",function(){return J});a.d(b,"InvalidEvent",function(){return t});a.d(b,"SigninEvent",function(){return u});a.d(b,"FollowUnfollowArticleEvent",function(){return K});a.d(b,"UpdateFollowUnfollowWidgetsStateEvent",function(){return L});a.d(b,"UpdateUserFollowingArticles",
function(){return M});a.d(b,"LoggedinEvent",function(){return v});a.d(b,"RedirectedEvent",function(){return w});a.d(b,"ExitEvent",function(){return x});a.d(b,"CommentCancelledEvent",function(){return N});a.d(b,"PopupEvent",function(){return O});a.d(b,"UpdateFrameTitleEvent",function(){return P});b.groveMessageExtractor=function(a){if(a&&a.data)return a.data.redirected?new w(a.data):a.data.loggedin?new v(a.data):a.data.signin?new u(a.data):"exit"===a.data.action?new x(a.data):new t(a.data);if("DEBUG"===
y)throw Q;};h=a("j/rp");var k=a.n(h);h=a("T/v0");var n=a.n(h);h=a("tNLN");var m=a.n(h);h=a("Oy1H");var p=a.n(h);h=a("Z60a");var d=a.n(h);h=a("C9uT");var g=a.n(h),e=function(){function a(c,b){d()(this,a);if(!c&&"DEBUG"===y)throw R;this._name=c;"object"===p()(b)?Object.assign(this,b):this.data=b}g()(a,[{key:"getName",value:function(){return this._name}}]);return a}(),q=function(a){function c(){d()(this,c);return b.call(this,c.evtName())}k()(c,a);var b=f(c);g()(c,null,[{key:"evtName",value:function(){return"GM_ADD_DUPLICATE_ARTICLE_TO_READING_LIST"}}]);
return c}(e),r=function(a){function c(a){d()(this,c);return b.call(this,c.evtName(),a)}k()(c,a);var b=f(c);g()(c,null,[{key:"evtName",value:function(){return"GM_WIDGET_INITIALIZED"}}]);return c}(e),z=function(a){function c(a){d()(this,c);return b.call(this,c.evtName(),a)}k()(c,a);var b=f(c);g()(c,null,[{key:"evtName",value:function(){return"GM_UPDATE_CURRENT_POLL"}}]);return c}(e),A=function(a){function c(a){d()(this,c);return b.call(this,c.evtName(),a)}k()(c,a);var b=f(c);g()(c,null,[{key:"evtName",
value:function(){return"GM_UPDATE_CURRENT_POLL_WIDGET"}}]);return c}(e),B=function(a){function c(a){d()(this,c);return b.call(this,c.evtName(),a)}k()(c,a);var b=f(c);g()(c,null,[{key:"evtName",value:function(){return"GM_WIDGET_DESTROYED"}}]);return c}(e),C=function(a){function c(a){d()(this,c);return b.call(this,c.evtName(),a)}k()(c,a);var b=f(c);g()(c,null,[{key:"evtName",value:function(){return"GM_TOGGLE_WIDGET"}}]);return c}(e),D=function(a){function c(a){d()(this,c);return b.call(this,c.evtName(),
a)}k()(c,a);var b=f(c);g()(c,null,[{key:"evtName",value:function(){return"GM_ACTIVE_SURVEYS"}}]);return c}(e),E=function(a){function c(a){d()(this,c);return b.call(this,c.evtName(),a)}k()(c,a);var b=f(c);g()(c,null,[{key:"evtName",value:function(){return"GM_UPDATE_SURVEY_FILTER"}}]);return c}(e),F=function(a){function c(a){d()(this,c);return b.call(this,c.evtName(),a)}k()(c,a);var b=f(c);g()(c,null,[{key:"evtName",value:function(){return"GM_INVALIDATE_SURVEY_FILTERS"}}]);return c}(e),G=function(a){function c(a){d()(this,
c);return b.call(this,c.evtName(),a)}k()(c,a);var b=f(c);g()(c,null,[{key:"evtName",value:function(){return"GM_LOGIN"}}]);return c}(e),H=function(a){function c(a){d()(this,c);return b.call(this,c.evtName(),a)}k()(c,a);var b=f(c);g()(c,null,[{key:"evtName",value:function(){return"GM_EXPAND_WIDGET"}}]);return c}(e),I=function(a){function c(a){d()(this,c);return b.call(this,c.evtName(),a)}k()(c,a);var b=f(c);g()(c,null,[{key:"evtName",value:function(){return"GM_RELOAD_WIDGET"}}]);return c}(e),J=function(a){function c(a){d()(this,
c);return b.call(this,c.evtName(),a)}k()(c,a);var b=f(c);g()(c,null,[{key:"evtName",value:function(){return"GM_SUBMIT_COMPLETED_SURVEY_ERROR"}}]);return c}(e),t=function(a){function c(a){d()(this,c);return b.call(this,c.evtName(),a)}k()(c,a);var b=f(c);g()(c,null,[{key:"evtName",value:function(){return"GM_INVALID"}}]);return c}(e),u=function(a){function c(a){d()(this,c);return b.call(this,c.evtName(),a)}k()(c,a);var b=f(c);g()(c,null,[{key:"evtName",value:function(){return"GM_SIGNIN"}}]);return c}(e),
K=function(a){function c(a){d()(this,c);return b.call(this,c.evtName(),{toFollow:a})}k()(c,a);var b=f(c);g()(c,null,[{key:"evtName",value:function(){return"GM_FOLLOW_UNFOLLOW_ARTICLE"}}]);return c}(e),L=function(a){function c(a){d()(this,c);return b.call(this,c.evtName(),{followState:a})}k()(c,a);var b=f(c);g()(c,null,[{key:"evtName",value:function(){return"GM_UPDATE_FOLLOW_UNFOLLOW_WIDGETS_STATE"}}]);return c}(e),M=function(a){function c(){d()(this,c);return b.call(this,c.evtName())}k()(c,a);var b=
f(c);g()(c,null,[{key:"evtName",value:function(){return"GM_UPDATE_USER_FOLLOWING_ARTICLES"}}]);return c}(e),v=function(a){function c(a){d()(this,c);return b.call(this,c.evtName(),a)}k()(c,a);var b=f(c);g()(c,null,[{key:"evtName",value:function(){return"GM_LOGGEDIN"}}]);return c}(e),w=function(a){function c(a){d()(this,c);return b.call(this,c.evtName(),a)}k()(c,a);var b=f(c);g()(c,null,[{key:"evtName",value:function(){return"GM_REDIRECTED"}}]);return c}(e),x=function(a){function c(a){d()(this,c);return b.call(this,
c.evtName(),a)}k()(c,a);var b=f(c);g()(c,null,[{key:"evtName",value:function(){return"GM_EXIT"}}]);return c}(e),N=function(a){function c(a){d()(this,c);return b.call(this,c.evtName(),a)}k()(c,a);var b=f(c);g()(c,null,[{key:"evtName",value:function(){return"GM_COMMENT_CANCELLED"}}]);return c}(e),O=function(a){function c(a){d()(this,c);return b.call(this,c.evtName(),a)}k()(c,a);var b=f(c);g()(c,null,[{key:"evtName",value:function(){return"GM_POPUP"}}]);return c}(e),P=function(a){function c(a){d()(this,
c);return b.call(this,c.evtName(),a)}k()(c,a);var b=f(c);g()(c,null,[{key:"evtName",value:function(){return"GM_UPDATE_FRAME_TITLE"}}]);return c}(e),y="DEBUG",R="UNKNOWN GROVEMESSAGE NAME ARGUMENT",Q="INVALID EVENT PAYLOAD ERROR"},jItp:function(h,b,a){function f(a,b,d,g){Object.defineProperty(b,d,{get:function(){return a[g]},set:function(b){a[g]=b},configurable:!1,enumerable:!0})}function l(){return(new Date).getTime()+"_"+Math.floor(99*Math.random())+1}function k(a,b,d,g,e){d=d||window.articleInfo&&
window.articleInfo.siteUrl||window.location.href;e=e||window.articleInfo&&window.articleInfo.doi;a=a||"HTML";-1<d.indexOf("://")&&(d=d.substring(d.indexOf("://")+3));return b&&p()(b,function(b){var h=b.type.toUpperCase(),f=b.context;f&&-1<f.indexOf("://")&&(f=f.substring(f.indexOf("://")+3));return h===a.toUpperCase()&&(f===d||e&&e===g)&&("HTML"!==a&&b.page||"HTML"===a&&!b.page)})[0]}Object.defineProperty(b,"__esModule",{value:!0});a.d(b,"setupProperty",function(){return f});a.d(b,"getMostRelativeContextRange",
function(){return k});a.d(b,"WindowEventManager",function(){return q});a.d(b,"getRandomId",function(){return l});h=a("Z60a");var n=a.n(h);h=a("C9uT");var m=a.n(h);h=a("RyI1");var p=a.n(h);h=a("KgVm");var d=a.n(h),g=a("JyB8");a.n(g);var e=function(){function a(b,d){n()(this,a);this.listener=b;this.unsubCallback=d}m()(a,[{key:"destroy",value:function(){this.unsubCallback=this.listener=null}}]);return a}(),q=function(){function a(b){n()(this,a);this.win=b;this.unsubCallbacks=new g.HolderUtil}m()(a,[{key:"subscribe",
value:function(a,b,d,g){this.win&&b&&"function"===typeof b&&(g=b,d&&(g=b.bind(d)),this.unsubCallbacks.contains(a)&&Array.isArray(this.unsubCallbacks.get(a))?this.unsubCallbacks.get(a).push(new e(b,g)):this.unsubCallbacks.put(a,[new e(b,g)]),this.win.addEventListener(a,g))}},{key:"unsubscribe",value:function(a,b){if(this.win&&a&&b){var g=this.unsubCallbacks.get(a);if(g&&Array.isArray(g)){var e=d()(g,function(a){return a&&a.listener===b});if(0<=e){var f=g[e];g.splice(e,1);this.win.removeEventListener(a,
f.unsubCallback);f.destroy()}}}}},{key:"unsubscribeAll",value:function(a){if(this.win&&a){var b=this.unsubCallbacks.get(a);if(b&&Array.isArray(b))for(;0<b.length;){var d=b[0];b.splice(0,1);this.win.removeEventListener(a,d.unsubCallback);d.destroy()}}}},{key:"destroy",value:function(){var a=this;this.unsubCallbacks&&(this.unsubCallbacks.values().forEach(function(b){return a.unsubscribeAll(b)}),this.unsubCallbacks.clear(),delete this.unsubCallbacks,delete this.win)}}]);return a}();(function(a){a&&!a.windowEventManager&&
Object.defineProperty(a,"windowEventManager",{get:function(){var b=new q(a);return function(){return b}}(),set:function(a){},configurable:!1,enumerable:!0})})(window)},xnW7:function(h,b,a){var f=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d])};return function(b,g){function d(){this.constructor=b}a(b,g);b.prototype=null===g?Object.create(g):(d.prototype=g.prototype,
new d)}}();Object.defineProperty(b,"__esModule",{value:!0});h=function(){function a(a,b,e){this.indication=a||"INVALID_TAB_NOTIFICATION";this.data=b;this.origin=e}a.prototype.destroy=function(){delete this.indication;delete this.data;delete this.origin};return a}();b.BaseCrossTabsEvent=h;var l=function(a){function b(d,e){return a.call(this,b.evtName(),d,e)||this}f(b,a);b.evtName=function(){return"TABS_EVENT_NEW_USER"};return b}(h);b.UserChangeCrossTabEvent=l;var k=function(a){function b(d,e){return a.call(this,
b.evtName(),d,e)||this}f(b,a);b.evtName=function(){return"TABS_EVENT_NEW_CONVERSATION"};return b}(h);b.NewConversationCrossTabEvent=k;var n=function(a){function b(d,e){return a.call(this,b.evtName(),d,e)||this}f(b,a);b.evtName=function(){return"TABS_EVENT_DELETE_CONVERSATION"};return b}(h);b.DeleteConversationCrossTabEvent=n;var m=function(a){function b(d,e){return a.call(this,b.evtName(),d,e)||this}f(b,a);b.evtName=function(){return"TABS_EVENT_EDIT_CONVERSATION"};return b}(h);b.EditConversationCrossTabEvent=
m;h=function(){function a(){}a.from=function(a,b,e){if(a&&b)switch(a){case l.evtName():return new l(b,e);case k.evtName():return new k(b,e);case m.evtName():return new m(b,e);case n.evtName():return new n(b,e)}return null};return a}();b.CrossTabsEventFactory=h},ynQ0:function(h,b,a){Object.defineProperty(b,"__esModule",{value:!0});a("u7Vc");var f=a("jItp"),l=a("xnW7"),k=a("Tkzw"),n=a("9LPS"),m=function(){function a(a){this.handledEvents=[l.UserChangeCrossTabEvent.evtName(),l.NewConversationCrossTabEvent.evtName(),
l.EditConversationCrossTabEvent.evtName(),l.DeleteConversationCrossTabEvent.evtName()];this.frameId="CrossTabsMessageBroker";this.window=a;this.windowEventManager=new f.WindowEventManager(a)}a.prototype.start=function(){this.initSubscriptions()};a.prototype.initSubscriptions=function(){var a=this;this.windowEventManager.subscribe("message",this.handleRMQEvent,this);this.windowEventManager.subscribe("storage",this.handleStorageEvent,this);var b=function(d){a.window.parent.postMessage(new k.WidgetInitializedEvent({widgetId:n.WIDGET_NAMES.CROSS_TABS_MESSAGE_BROKER}),
"*");a.windowEventManager.unsubscribe("DOMContentLoaded",b)};this.windowEventManager.subscribe("DOMContentLoaded",b)};a.prototype.handleRMQEvent=function(a){a&&a.data&&a.data.indication&&0<=this.handledEvents.indexOf(a.data.indication)&&this.notifyTabs(a.data)};a.prototype.handleStorageEvent=function(a){a&&a.key&&0<=this.handledEvents.indexOf(a.key)&&(a=l.CrossTabsEventFactory.from(a&&a.key,a&&a.newValue&&JSON.parse(a.newValue),this.frameId))&&this.postMessageToParent(a)};a.prototype.postMessageToParent=
function(a){this.window.parent.postMessage(a,"*")};a.prototype.notifyTabs=function(a){var b=null;try{b=this.window&&this.window.localStorage}catch(r){}if(a&&b){var d=a.indication,f=JSON.stringify(a.data);b.setItem(d,f);b.removeItem(a.indication)}};return a}();(function(a){a=new m(a);a.start();return a})(window)}},[20]);

//# sourceMappingURL=crossTabsMessageBroker.963de3c6.bundle.js.map